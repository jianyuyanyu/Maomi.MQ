# 自定义消费者和动态订阅



```csharp
public class DynamicCustomConsumer : IConsumer<TestEvent>
{
    public Task ExecuteAsync(EventBody<TestEvent> message)
    {
        throw new NotImplementedException();
    }

    public Task FaildAsync(Exception ex, int retryCount, EventBody<TestEvent>? message)
    {
        throw new NotImplementedException();
    }

    public Task<bool> FallbackAsync(EventBody<TestEvent>? message)
    {
        throw new NotImplementedException();
    }
}
```



```csharp
DynamicConsumerTypeFilter dynamicConsumerTypeFilter = new();
dynamicConsumerTypeFilter.AddConsumer(typeof(DynamicCustomConsumer), new ConsumerOptions
{
	Queue = "test"
});

builder.Services.AddMaomiMQ((MqOptionsBuilder options) =>
{
	options.WorkId = 1;
	options.AutoQueueDeclare = true;
	options.AppName = "myapp";
	options.Rabbit = (ConnectionFactory options) =>
	{
		options.HostName = "10.1.0.6";
		options.ClientProvidedName = Assembly.GetExecutingAssembly().GetName().Name;
	};
}, [typeof(Program).Assembly], [new ConsumerTypeFilter(ConsumerInterceptor), new EventBusTypeFilter(EventInterceptor), dynamicConsumerTypeFilter]);
```

![image-20240720212715583](images/image-20240720212715583.png)
